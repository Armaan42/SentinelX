// Extended Vulnerability Signature Database - 100+ signatures

export interface VulnerabilitySignature {
  id: string;
  title: string;
  owasp_category: string;
  severity: 'info' | 'low' | 'medium' | 'high' | 'critical';
  detection_type: 'header_missing' | 'header_value' | 'content_match' | 'tech_fingerprint' | 'behavior' | 'misconfiguration';
  pattern?: string | RegExp;
  header_name?: string;
  expected_value?: string | RegExp;
  negative_match?: boolean;
  confidence_base: number;
  recommendation: string;
  references: string[];
}

export const SIGNATURE_DATABASE: VulnerabilitySignature[] = [
  // ═══════════════════════════════════════════════════════════════
  // A01:2021 - Broken Access Control (15 signatures)
  // ═══════════════════════════════════════════════════════════════
  {
    id: "SIG-A01-001",
    title: "Directory Listing Enabled",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "medium",
    detection_type: "content_match",
    pattern: /Index of \//i,
    confidence_base: 90,
    recommendation: "Disable directory listing in web server configuration",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-002",
    title: "Exposed Admin Panel",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "high",
    detection_type: "content_match",
    pattern: /(admin portal|administration|control panel)/i,
    confidence_base: 60,
    recommendation: "Implement proper authentication and restrict admin panel access",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-003",
    title: "Wildcard CORS Configuration",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "high",
    detection_type: "header_value",
    header_name: "access-control-allow-origin",
    expected_value: "*",
    confidence_base: 95,
    recommendation: "Restrict CORS to specific trusted domains",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-004",
    title: "Path Traversal Vulnerability",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "critical",
    detection_type: "behavior",
    pattern: /\?.*(\.\.|%2e%2e|\.\.%2f|%2e%2e%2f)/i,
    confidence_base: 85,
    recommendation: "Sanitize file path inputs and implement proper access controls",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-005",
    title: "Exposed Backup Files",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "high",
    detection_type: "content_match",
    pattern: /(\.bak|\.backup|\.old|\.tmp|~)/i,
    confidence_base: 80,
    recommendation: "Remove backup files from web-accessible directories",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-006",
    title: "Insecure Direct Object References",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "high",
    detection_type: "behavior",
    pattern: /\?(id|user_id|account)=[0-9]+/i,
    confidence_base: 45,
    recommendation: "Implement proper authorization checks for object access",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-007",
    title: "Missing Authorization Header",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "medium",
    detection_type: "header_missing",
    header_name: "authorization",
    negative_match: true,
    confidence_base: 40,
    recommendation: "Implement proper authentication mechanisms",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-008",
    title: "Exposed phpinfo() Page",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "high",
    detection_type: "content_match",
    pattern: /phpinfo\(\)/i,
    confidence_base: 95,
    recommendation: "Remove phpinfo() pages from production",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-009",
    title: "HTTP Methods Enabled",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "medium",
    detection_type: "header_value",
    header_name: "allow",
    expected_value: /(PUT|DELETE|TRACE|CONNECT)/i,
    confidence_base: 70,
    recommendation: "Disable unnecessary HTTP methods",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-010",
    title: "Exposed Server Status Page",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "medium",
    detection_type: "content_match",
    pattern: /(server-status|server-info|nginx_status)/i,
    confidence_base: 85,
    recommendation: "Restrict access to server status pages",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-011",
    title: "Forced Browsing Vulnerability",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "medium",
    detection_type: "content_match",
    pattern: /(private|internal|restricted|confidential)/i,
    confidence_base: 50,
    recommendation: "Implement proper access controls on all resources",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-012",
    title: "Missing Rate Limiting",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "medium",
    detection_type: "header_missing",
    header_name: "x-ratelimit-limit",
    negative_match: true,
    confidence_base: 35,
    recommendation: "Implement rate limiting to prevent abuse",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-013",
    title: "Unrestricted File Upload",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "critical",
    detection_type: "content_match",
    pattern: /(file upload|upload file|choose file)/i,
    confidence_base: 40,
    recommendation: "Implement file type validation and size restrictions",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-014",
    title: "Exposed Configuration Files",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "critical",
    detection_type: "content_match",
    pattern: /(web\.config|application\.properties|config\.json|settings\.xml)/i,
    confidence_base: 90,
    recommendation: "Remove configuration files from web root",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-015",
    title: "Session Fixation Vulnerability",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "high",
    detection_type: "header_value",
    header_name: "set-cookie",
    expected_value: /session/i,
    confidence_base: 45,
    recommendation: "Regenerate session IDs after authentication",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },

  // ═══════════════════════════════════════════════════════════════
  // A02:2021 - Cryptographic Failures (12 signatures)
  // ═══════════════════════════════════════════════════════════════
  {
    id: "SIG-A02-001",
    title: "Missing Strict-Transport-Security",
    owasp_category: "A02:2021 - Cryptographic Failures",
    severity: "high",
    detection_type: "header_missing",
    header_name: "strict-transport-security",
    negative_match: true,
    confidence_base: 85,
    recommendation: "Add HSTS header with min 1 year max-age",
    references: ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"]
  },
  {
    id: "SIG-A02-002",
    title: "Weak HSTS Max-Age",
    owasp_category: "A02:2021 - Cryptographic Failures",
    severity: "medium",
    detection_type: "header_value",
    header_name: "strict-transport-security",
    expected_value: /max-age=([0-9]+)/,
    confidence_base: 70,
    recommendation: "Set HSTS max-age to at least 31536000",
    references: ["https://hstspreload.org/"]
  },
  {
    id: "SIG-A02-003",
    title: "Missing Secure Cookie Flag",
    owasp_category: "A02:2021 - Cryptographic Failures",
    severity: "high",
    detection_type: "header_value",
    header_name: "set-cookie",
    expected_value: /(?!.*Secure)/,
    confidence_base: 75,
    recommendation: "Set Secure flag on all cookies",
    references: ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"]
  },
  {
    id: "SIG-A02-004",
    title: "Missing HttpOnly Cookie Flag",
    owasp_category: "A02:2021 - Cryptographic Failures",
    severity: "medium",
    detection_type: "header_value",
    header_name: "set-cookie",
    expected_value: /(?!.*HttpOnly)/,
    confidence_base: 70,
    recommendation: "Set HttpOnly flag on session cookies",
    references: ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"]
  },
  {
    id: "SIG-A02-005",
    title: "Weak SSL/TLS Protocol",
    owasp_category: "A02:2021 - Cryptographic Failures",
    severity: "critical",
    detection_type: "content_match",
    pattern: /(TLSv1\.0|TLSv1\.1|SSLv2|SSLv3)/i,
    confidence_base: 90,
    recommendation: "Use TLS 1.2 or TLS 1.3 only",
    references: ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"]
  },
  {
    id: "SIG-A02-006",
    title: "Sensitive Data in URL",
    owasp_category: "A02:2021 - Cryptographic Failures",
    severity: "high",
    detection_type: "behavior",
    pattern: /\?(password|token|api_key|secret)=/i,
    confidence_base: 85,
    recommendation: "Never pass sensitive data in URLs",
    references: ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"]
  },
  {
    id: "SIG-A02-007",
    title: "Weak Cipher Suites",
    owasp_category: "A02:2021 - Cryptographic Failures",
    severity: "high",
    detection_type: "content_match",
    pattern: /(RC4|DES|3DES|MD5)/i,
    confidence_base: 80,
    recommendation: "Use strong cipher suites (AES-GCM, ChaCha20)",
    references: ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"]
  },
  {
    id: "SIG-A02-008",
    title: "Certificate Validation Disabled",
    owasp_category: "A02:2021 - Cryptographic Failures",
    severity: "critical",
    detection_type: "content_match",
    pattern: /(verify.*false|ssl.*verify.*false)/i,
    confidence_base: 90,
    recommendation: "Enable SSL/TLS certificate validation",
    references: ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"]
  },
  {
    id: "SIG-A02-009",
    title: "Hardcoded Cryptographic Keys",
    owasp_category: "A02:2021 - Cryptographic Failures",
    severity: "critical",
    detection_type: "content_match",
    pattern: /(encryption.*key|secret.*key|private.*key).*[=:]\s*["'][^"']{20,}/i,
    confidence_base: 85,
    recommendation: "Use secure key management systems",
    references: ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"]
  },
  {
    id: "SIG-A02-010",
    title: "Missing SameSite Cookie Attribute",
    owasp_category: "A02:2021 - Cryptographic Failures",
    severity: "medium",
    detection_type: "header_value",
    header_name: "set-cookie",
    expected_value: /(?!.*SameSite)/,
    confidence_base: 65,
    recommendation: "Set SameSite=Strict or SameSite=Lax",
    references: ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"]
  },
  {
    id: "SIG-A02-011",
    title: "Unencrypted Sensitive Data Storage",
    owasp_category: "A02:2021 - Cryptographic Failures",
    severity: "critical",
    detection_type: "content_match",
    pattern: /(localStorage|sessionStorage).*password/i,
    confidence_base: 75,
    recommendation: "Never store sensitive data in browser storage",
    references: ["https://owasp.org/Top10/A02_2021-Cryptographic Failures/"]
  },
  {
    id: "SIG-A02-012",
    title: "Weak Password Hashing",
    owasp_category: "A02:2021 - Cryptographic Failures",
    severity: "critical",
    detection_type: "content_match",
    pattern: /(md5|sha1)\(.*password/i,
    confidence_base: 85,
    recommendation: "Use bcrypt, scrypt, or Argon2 for password hashing",
    references: ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"]
  },

  // ═══════════════════════════════════════════════════════════════
  // A04:2021 - Insecure Design (10 signatures)
  // ═══════════════════════════════════════════════════════════════
  {
    id: "SIG-A04-001",
    title: "Missing Content-Security-Policy",
    owasp_category: "A04:2021 - Insecure Design",
    severity: "medium",
    detection_type: "header_missing",
    header_name: "content-security-policy",
    negative_match: true,
    confidence_base: 70,
    recommendation: "Implement strict CSP",
    references: ["https://owasp.org/Top10/A04_2021-Insecure_Design/"]
  },
  {
    id: "SIG-A04-002",
    title: "Weak CSP Configuration",
    owasp_category: "A04:2021 - Insecure Design",
    severity: "medium",
    detection_type: "header_value",
    header_name: "content-security-policy",
    expected_value: /'unsafe-inline'|'unsafe-eval'/,
    confidence_base: 65,
    recommendation: "Remove unsafe-inline and unsafe-eval from CSP",
    references: ["https://content-security-policy.com/"]
  },
  {
    id: "SIG-A04-003",
    title: "Missing X-Frame-Options",
    owasp_category: "A04:2021 - Insecure Design",
    severity: "medium",
    detection_type: "header_missing",
    header_name: "x-frame-options",
    negative_match: true,
    confidence_base: 75,
    recommendation: "Add X-Frame-Options: DENY",
    references: ["https://owasp.org/Top10/A04_2021-Insecure_Design/"]
  },
  {
    id: "SIG-A04-004",
    title: "Clickjacking Vulnerability",
    owasp_category: "A04:2021 - Insecure Design",
    severity: "medium",
    detection_type: "content_match",
    pattern: /<iframe|<frame/i,
    confidence_base: 45,
    recommendation: "Implement frame-busting code",
    references: ["https://owasp.org/Top10/A04_2021-Insecure_Design/"]
  },
  {
    id: "SIG-A04-005",
    title: "Open Redirect Vulnerability",
    owasp_category: "A04:2021 - Insecure Design",
    severity: "high",
    detection_type: "behavior",
    pattern: /[?&](redirect|url|return|next)=/i,
    confidence_base: 50,
    recommendation: "Validate redirect URLs against whitelist",
    references: ["https://owasp.org/Top10/A04_2021-Insecure_Design/"]
  },
  {
    id: "SIG-A04-006",
    title: "Missing Anti-CSRF Token",
    owasp_category: "A04:2021 - Insecure Design",
    severity: "high",
    detection_type: "content_match",
    pattern: /<form.*method=["']post/i,
    confidence_base: 40,
    recommendation: "Implement CSRF tokens on all forms",
    references: ["https://owasp.org/Top10/A04_2021-Insecure_Design/"]
  },
  {
    id: "SIG-A04-007",
    title: "Insufficient Input Validation",
    owasp_category: "A04:2021 - Insecure Design",
    severity: "medium",
    detection_type: "content_match",
    pattern: /<input[^>]*type=["']text[^>]*>/i,
    confidence_base: 30,
    recommendation: "Implement comprehensive input validation",
    references: ["https://owasp.org/Top10/A04_2021-Insecure_Design/"]
  },
  {
    id: "SIG-A04-008",
    title: "Business Logic Flaw Indicators",
    owasp_category: "A04:2021 - Insecure Design",
    severity: "medium",
    detection_type: "content_match",
    pattern: /(checkout|payment|order|cart)/i,
    confidence_base: 35,
    recommendation: "Review business logic security",
    references: ["https://owasp.org/Top10/A04_2021-Insecure_Design/"]
  },
  {
    id: "SIG-A04-009",
    title: "Insecure State Management",
    owasp_category: "A04:2021 - Insecure Design",
    severity: "medium",
    detection_type: "content_match",
    pattern: /(hidden.*value|input.*type.*hidden)/i,
    confidence_base: 40,
    recommendation: "Store state server-side",
    references: ["https://owasp.org/Top10/A04_2021-Insecure_Design/"]
  },
  {
    id: "SIG-A04-010",
    title: "Race Condition Vulnerability",
    owasp_category: "A04:2021 - Insecure Design",
    severity: "medium",
    detection_type: "content_match",
    pattern: /(concurrent|parallel|async)/i,
    confidence_base: 30,
    recommendation: "Implement proper locking mechanisms",
    references: ["https://owasp.org/Top10/A04_2021-Insecure_Design/"]
  },

  // A05: Security Misconfiguration (15 signatures)
  {
    id: "SIG-A05-001",
    title: "Server Version Disclosure",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "low",
    detection_type: "header_value",
    header_name: "server",
    expected_value: /(Apache|nginx|IIS)\/[0-9\.]+/i,
    confidence_base: 90,
    recommendation: "Remove server version info",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-002",
    title: "X-Powered-By Header Disclosure",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "low",
    detection_type: "header_value",
    header_name: "x-powered-by",
    expected_value: /.+/,
    confidence_base: 85,
    recommendation: "Remove X-Powered-By header",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-003",
    title: "Missing X-Content-Type-Options",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "low",
    detection_type: "header_missing",
    header_name: "x-content-type-options",
    negative_match: true,
    confidence_base: 70,
    recommendation: "Add X-Content-Type-Options: nosniff",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-004",
    title: "Missing Referrer-Policy",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "low",
    detection_type: "header_missing",
    header_name: "referrer-policy",
    negative_match: true,
    confidence_base: 60,
    recommendation: "Implement Referrer-Policy",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-005",
    title: "Exposed Git Directory",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "critical",
    detection_type: "content_match",
    pattern: /\.git\/(config|HEAD|index)/,
    confidence_base: 95,
    recommendation: "Block .git directory access",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-006",
    title: "Exposed Environment File",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "critical",
    detection_type: "content_match",
    pattern: /\.env|DB_PASSWORD|API_KEY/i,
    confidence_base: 95,
    recommendation: "Remove .env files from web root",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-007",
    title: "Default Credentials",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "critical",
    detection_type: "content_match",
    pattern: /(admin\/admin|root\/root|administrator\/password)/i,
    confidence_base: 80,
    recommendation: "Change all default credentials",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-008",
    title: "Directory Browsing Enabled",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "medium",
    detection_type: "content_match",
    pattern: /(Parent Directory|Index of)/i,
    confidence_base: 85,
    recommendation: "Disable directory browsing",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-009",
    title: "Unnecessary HTTP Methods",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "medium",
    detection_type: "header_value",
    header_name: "allow",
    expected_value: /(TRACE|OPTIONS|PUT)/i,
    confidence_base: 70,
    recommendation: "Disable unnecessary HTTP methods",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-010",
    title: "Error Page Information Leakage",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "low",
    detection_type: "content_match",
    pattern: /(404 Not Found|500 Internal Server Error)/i,
    confidence_base: 60,
    recommendation: "Use custom error pages",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-011",
    title: "Exposed Admin Interface",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "high",
    detection_type: "content_match",
    pattern: /(phpmyadmin|adminer|pgadmin)/i,
    confidence_base: 90,
    recommendation: "Restrict admin interface access",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-012",
    title: "Missing Security Headers Bundle",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "medium",
    detection_type: "header_missing",
    header_name: "permissions-policy",
    negative_match: true,
    confidence_base: 50,
    recommendation: "Implement Permissions-Policy header",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-013",
    title: "Verbose Error Messages",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "medium",
    detection_type: "content_match",
    pattern: /(Warning|Notice|Parse error|Fatal error)/i,
    confidence_base: 75,
    recommendation: "Disable verbose error messages",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-014",
    title: "Insecure HTTP Allowed",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "high",
    detection_type: "content_match",
    pattern: /http:\/\/(www\.)?[a-z0-9-]+\.[a-z]{2,}/i,
    confidence_base: 45,
    recommendation: "Enforce HTTPS everywhere",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-015",
    title: "Robots.txt Information Disclosure",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "info",
    detection_type: "content_match",
    pattern: /Disallow:.*\/(admin|private)/i,
    confidence_base: 60,
    recommendation: "Review robots.txt for sensitive paths",
    references: ["https://www.robotstxt.org/"]
  },

  // A06: Vulnerable Components (10 signatures)
  {
    id: "SIG-A06-001",
    title: "WordPress Detected",
    owasp_category: "A06:2021 - Vulnerable and Outdated Components",
    severity: "info",
    detection_type: "tech_fingerprint",
    pattern: /wp-content|wp-includes/i,
    confidence_base: 95,
    recommendation: "Keep WordPress updated",
    references: ["https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"]
  },
  {
    id: "SIG-A06-002",
    title: "jQuery Version Detection",
    owasp_category: "A06:2021 - Vulnerable and Outdated Components",
    severity: "low",
    detection_type: "tech_fingerprint",
    pattern: /jquery[.-]([0-9\.]+)/i,
    confidence_base: 70,
    recommendation: "Update jQuery to 3.6.0+",
    references: ["https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"]
  },
  {
    id: "SIG-A06-003",
    title: "PHP Version Disclosure",
    owasp_category: "A06:2021 - Vulnerable and Outdated Components",
    severity: "medium",
    detection_type: "header_value",
    header_name: "x-powered-by",
    expected_value: /PHP\/([0-9\.]+)/i,
    confidence_base: 90,
    recommendation: "Update PHP and remove version header",
    references: ["https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"]
  },
  {
    id: "SIG-A06-004",
    title: "Outdated JavaScript Libraries",
    owasp_category: "A06:2021 - Vulnerable and Outdated Components",
    severity: "medium",
    detection_type: "tech_fingerprint",
    pattern: /(angular|react|vue).*[0-9\.]+/i,
    confidence_base: 55,
    recommendation: "Update JavaScript frameworks",
    references: ["https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"]
  },
  {
    id: "SIG-A06-005",
    title: "Apache Struts Detected",
    owasp_category: "A06:2021 - Vulnerable and Outdated Components",
    severity: "high",
    detection_type: "tech_fingerprint",
    pattern: /struts/i,
    confidence_base: 80,
    recommendation: "Update Apache Struts immediately",
    references: ["https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"]
  },
  {
    id: "SIG-A06-006",
    title: "Node.js Version Disclosure",
    owasp_category: "A06:2021 - Vulnerable and Outdated Components",
    severity: "medium",
    detection_type: "header_value",
    header_name: "x-powered-by",
    expected_value: /Express/i,
    confidence_base: 75,
    recommendation: "Update Node.js and Express",
    references: ["https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"]
  },
  {
    id: "SIG-A06-007",
    title: "Drupal CMS Detected",
    owasp_category: "A06:2021 - Vulnerable and Outdated Components",
    severity: "info",
    detection_type: "tech_fingerprint",
    pattern: /drupal|sites\/default/i,
    confidence_base: 85,
    recommendation: "Keep Drupal core and modules updated",
    references: ["https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"]
  },
  {
    id: "SIG-A06-008",
    title: "Joomla CMS Detected",
    owasp_category: "A06:2021 - Vulnerable and Outdated Components",
    severity: "info",
    detection_type: "tech_fingerprint",
    pattern: /joomla|\/components\/com_/i,
    confidence_base: 85,
    recommendation: "Keep Joomla updated",
    references: ["https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"]
  },
  {
    id: "SIG-A06-009",
    title: "Magento E-commerce Platform",
    owasp_category: "A06:2021 - Vulnerable and Outdated Components",
    severity: "info",
    detection_type: "tech_fingerprint",
    pattern: /magento|\/skin\/frontend/i,
    confidence_base: 85,
    recommendation: "Keep Magento patched",
    references: ["https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"]
  },
  {
    id: "SIG-A06-010",
    title: "Bootstrap Framework Version",
    owasp_category: "A06:2021 - Vulnerable and Outdated Components",
    severity: "low",
    detection_type: "tech_fingerprint",
    pattern: /bootstrap[.-]([0-9\.]+)/i,
    confidence_base: 65,
    recommendation: "Update Bootstrap to latest version",
    references: ["https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"]
  },

  // ═══════════════════════════════════════════════════════════════
  // A07:2021 - Identification and Authentication Failures (12 signatures)
  // ═══════════════════════════════════════════════════════════════
  {
    id: "SIG-A07-001",
    title: "Weak Session Cookie Configuration",
    owasp_category: "A07:2021 - Identification and Authentication Failures",
    severity: "high",
    detection_type: "header_value",
    header_name: "set-cookie",
    expected_value: /secure|httponly/i,
    negative_match: true,
    confidence_base: 80,
    recommendation: "Set Secure and HttpOnly flags on session cookies",
    references: ["https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/"]
  },
  {
    id: "SIG-A07-002",
    title: "Missing SameSite Cookie Attribute",
    owasp_category: "A07:2021 - Identification and Authentication Failures",
    severity: "medium",
    detection_type: "header_value",
    header_name: "set-cookie",
    expected_value: /samesite/i,
    negative_match: true,
    confidence_base: 75,
    recommendation: "Add SameSite attribute to cookies",
    references: ["https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/"]
  },
  {
    id: "SIG-A07-003",
    title: "Weak Password Policy Indicators",
    owasp_category: "A07:2021 - Identification and Authentication Failures",
    severity: "medium",
    detection_type: "content_match",
    pattern: /(password.*length.*[4-6]|min.*password.*[4-6])/i,
    confidence_base: 60,
    recommendation: "Enforce strong password policies (min 12 characters)",
    references: ["https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/"]
  },
  {
    id: "SIG-A07-004",
    title: "Username Enumeration Possible",
    owasp_category: "A07:2021 - Identification and Authentication Failures",
    severity: "medium",
    detection_type: "content_match",
    pattern: /(user.*not.*found|invalid.*username|username.*does.*not.*exist)/i,
    confidence_base: 55,
    recommendation: "Use generic error messages for authentication failures",
    references: ["https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/"]
  },
  {
    id: "SIG-A07-005",
    title: "Missing Rate Limiting",
    owasp_category: "A07:2021 - Identification and Authentication Failures",
    severity: "high",
    detection_type: "header_missing",
    header_name: "x-ratelimit-limit",
    confidence_base: 40,
    recommendation: "Implement rate limiting on authentication endpoints",
    references: ["https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/"]
  },
  {
    id: "SIG-A07-006",
    title: "Basic Auth Over HTTP",
    owasp_category: "A07:2021 - Identification and Authentication Failures",
    severity: "critical",
    detection_type: "header_value",
    header_name: "www-authenticate",
    expected_value: /basic/i,
    confidence_base: 90,
    recommendation: "Use HTTPS for Basic Auth or implement OAuth 2.0",
    references: ["https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/"]
  },
  {
    id: "SIG-A07-007",
    title: "Default Credentials Page",
    owasp_category: "A07:2021 - Identification and Authentication Failures",
    severity: "critical",
    detection_type: "content_match",
    pattern: /(admin:admin|root:root|default.*password)/i,
    confidence_base: 85,
    recommendation: "Change default credentials immediately",
    references: ["https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/"]
  },
  {
    id: "SIG-A07-008",
    title: "JWT in URL Parameter",
    owasp_category: "A07:2021 - Identification and Authentication Failures",
    severity: "high",
    detection_type: "behavior",
    pattern: /[?&]token=[A-Za-z0-9_-]+\.[A-Za-z0-9_-]+\.[A-Za-z0-9_-]+/,
    confidence_base: 80,
    recommendation: "Pass JWTs in Authorization header, not URL",
    references: ["https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/"]
  },
  {
    id: "SIG-A07-009",
    title: "Session Fixation Vulnerability",
    owasp_category: "A07:2021 - Identification and Authentication Failures",
    severity: "high",
    detection_type: "content_match",
    pattern: /session.*id.*url|sessionid=/i,
    confidence_base: 60,
    recommendation: "Regenerate session IDs after authentication",
    references: ["https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/"]
  },
  {
    id: "SIG-A07-010",
    title: "Multi-Factor Authentication Missing",
    owasp_category: "A07:2021 - Identification and Authentication Failures",
    severity: "medium",
    detection_type: "content_match",
    pattern: /login|signin|authenticate/i,
    confidence_base: 30,
    recommendation: "Implement MFA for privileged accounts",
    references: ["https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/"]
  },
  {
    id: "SIG-A07-011",
    title: "Credential Stuffing Protection Missing",
    owasp_category: "A07:2021 - Identification and Authentication Failures",
    severity: "high",
    detection_type: "header_missing",
    header_name: "x-captcha-required",
    confidence_base: 35,
    recommendation: "Implement CAPTCHA and anomaly detection",
    references: ["https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/"]
  },
  {
    id: "SIG-A07-012",
    title: "Password Reset Token in URL",
    owasp_category: "A07:2021 - Identification and Authentication Failures",
    severity: "high",
    detection_type: "behavior",
    pattern: /reset.*token|token.*reset/i,
    confidence_base: 50,
    recommendation: "Use POST requests and short-lived tokens for password resets",
    references: ["https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/"]
  },

  // ═══════════════════════════════════════════════════════════════
  // A08:2021 - Software and Data Integrity Failures (10 signatures)
  // ═══════════════════════════════════════════════════════════════
  {
    id: "SIG-A08-001",
    title: "Missing Subresource Integrity",
    owasp_category: "A08:2021 - Software and Data Integrity Failures",
    severity: "medium",
    detection_type: "content_match",
    pattern: /<script[^>]+src=["']https?:\/\/[^"']+["'](?![^>]*integrity=)/i,
    confidence_base: 70,
    recommendation: "Add SRI hashes to external scripts",
    references: ["https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/"]
  },
  {
    id: "SIG-A08-002",
    title: "Unsigned Software Updates",
    owasp_category: "A08:2021 - Software and Data Integrity Failures",
    severity: "high",
    detection_type: "content_match",
    pattern: /(download|update).*\.(exe|dmg|pkg|msi)/i,
    confidence_base: 45,
    recommendation: "Digitally sign all software updates",
    references: ["https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/"]
  },
  {
    id: "SIG-A08-003",
    title: "Insecure Deserialization Indicators",
    owasp_category: "A08:2021 - Software and Data Integrity Failures",
    severity: "critical",
    detection_type: "content_match",
    pattern: /(pickle|yaml\.load|unserialize|ObjectInputStream)/i,
    confidence_base: 70,
    recommendation: "Avoid deserializing untrusted data",
    references: ["https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/"]
  },
  {
    id: "SIG-A08-004",
    title: "CI/CD Pipeline Exposure",
    owasp_category: "A08:2021 - Software and Data Integrity Failures",
    severity: "high",
    detection_type: "content_match",
    pattern: /(jenkins|gitlab-ci|\.github\/workflows|circleci)/i,
    confidence_base: 60,
    recommendation: "Secure CI/CD pipelines and credentials",
    references: ["https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/"]
  },
  {
    id: "SIG-A08-005",
    title: "Webpack Source Maps Exposed",
    owasp_category: "A08:2021 - Software and Data Integrity Failures",
    severity: "medium",
    detection_type: "content_match",
    pattern: /\.map["']|sourceMappingURL/i,
    confidence_base: 80,
    recommendation: "Disable source maps in production",
    references: ["https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/"]
  },
  {
    id: "SIG-A08-006",
    title: "NPM Package Integrity",
    owasp_category: "A08:2021 - Software and Data Integrity Failures",
    severity: "low",
    detection_type: "content_match",
    pattern: /package\.json|node_modules/i,
    confidence_base: 30,
    recommendation: "Use package lock files and verify checksums",
    references: ["https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/"]
  },
  {
    id: "SIG-A08-007",
    title: "Docker Image from Untrusted Source",
    owasp_category: "A08:2021 - Software and Data Integrity Failures",
    severity: "medium",
    detection_type: "content_match",
    pattern: /FROM.*:latest|FROM.*\/[^\/]+$/i,
    confidence_base: 40,
    recommendation: "Use specific image tags from trusted registries",
    references: ["https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/"]
  },
  {
    id: "SIG-A08-008",
    title: "Auto-Update Without Verification",
    owasp_category: "A08:2021 - Software and Data Integrity Failures",
    severity: "high",
    detection_type: "content_match",
    pattern: /(auto.*update|automatic.*update)/i,
    confidence_base: 35,
    recommendation: "Verify signatures before auto-updates",
    references: ["https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/"]
  },
  {
    id: "SIG-A08-009",
    title: "Build Artifacts in Production",
    owasp_category: "A08:2021 - Software and Data Integrity Failures",
    severity: "low",
    detection_type: "content_match",
    pattern: /(\.git\/|\.svn\/|\.env\.example|README\.md)/i,
    confidence_base: 75,
    recommendation: "Remove build artifacts from production",
    references: ["https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/"]
  },
  {
    id: "SIG-A08-010",
    title: "Compromised CDN Risk",
    owasp_category: "A08:2021 - Software and Data Integrity Failures",
    severity: "medium",
    detection_type: "content_match",
    pattern: /cdn\.|cdnjs\.|jsdelivr\./i,
    confidence_base: 25,
    recommendation: "Use SRI for all CDN resources",
    references: ["https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/"]
  },

  // ═══════════════════════════════════════════════════════════════
  // A09:2021 - Security Logging and Monitoring Failures (10 signatures)
  // ═══════════════════════════════════════════════════════════════
  {
    id: "SIG-A09-001",
    title: "Debug Mode Enabled",
    owasp_category: "A09:2021 - Security Logging and Monitoring Failures",
    severity: "high",
    detection_type: "content_match",
    pattern: /(DEBUG|TRACE|var_dump|print_r|console\.log)/i,
    confidence_base: 80,
    recommendation: "Disable debug mode in production",
    references: ["https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/"]
  },
  {
    id: "SIG-A09-002",
    title: "Error Messages Disclosure",
    owasp_category: "A09:2021 - Security Logging and Monitoring Failures",
    severity: "medium",
    detection_type: "content_match",
    pattern: /(stack trace|SQLException|error.*line.*[0-9]+|fatal error)/i,
    confidence_base: 75,
    recommendation: "Use generic error messages and log details server-side",
    references: ["https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/"]
  },
  {
    id: "SIG-A09-003",
    title: "Missing Security Event Logging",
    owasp_category: "A09:2021 - Security Logging and Monitoring Failures",
    severity: "medium",
    detection_type: "header_missing",
    header_name: "x-logging-enabled",
    confidence_base: 20,
    recommendation: "Log all security events (login, access, changes)",
    references: ["https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/"]
  },
  {
    id: "SIG-A09-004",
    title: "Insufficient Monitoring Alerts",
    owasp_category: "A09:2021 - Security Logging and Monitoring Failures",
    severity: "medium",
    detection_type: "header_missing",
    header_name: "x-alert-configured",
    confidence_base: 15,
    recommendation: "Configure real-time security alerts",
    references: ["https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/"]
  },
  {
    id: "SIG-A09-005",
    title: "Log Injection Vulnerability",
    owasp_category: "A09:2021 - Security Logging and Monitoring Failures",
    severity: "high",
    detection_type: "content_match",
    pattern: /log\s*\(\s*[^)]*user|logger\.[^(]*\([^)]*request/i,
    confidence_base: 40,
    recommendation: "Sanitize all user input before logging",
    references: ["https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/"]
  },
  {
    id: "SIG-A09-006",
    title: "Sensitive Data in Logs",
    owasp_category: "A09:2021 - Security Logging and Monitoring Failures",
    severity: "high",
    detection_type: "content_match",
    pattern: /(password|secret|token|api.*key).*log/i,
    confidence_base: 60,
    recommendation: "Never log sensitive data like passwords or tokens",
    references: ["https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/"]
  },
  {
    id: "SIG-A09-007",
    title: "Missing Audit Trail",
    owasp_category: "A09:2021 - Security Logging and Monitoring Failures",
    severity: "medium",
    detection_type: "misconfiguration",
    confidence_base: 25,
    recommendation: "Implement comprehensive audit logging",
    references: ["https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/"]
  },
  {
    id: "SIG-A09-008",
    title: "Log Tampering Prevention Missing",
    owasp_category: "A09:2021 - Security Logging and Monitoring Failures",
    severity: "medium",
    detection_type: "misconfiguration",
    confidence_base: 20,
    recommendation: "Use append-only logs with integrity checks",
    references: ["https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/"]
  },
  {
    id: "SIG-A09-009",
    title: "Incident Response Plan Missing",
    owasp_category: "A09:2021 - Security Logging and Monitoring Failures",
    severity: "low",
    detection_type: "misconfiguration",
    confidence_base: 10,
    recommendation: "Develop and test incident response procedures",
    references: ["https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/"]
  },
  {
    id: "SIG-A09-010",
    title: "Security Information Exposure",
    owasp_category: "A09:2021 - Security Logging and Monitoring Failures",
    severity: "medium",
    detection_type: "content_match",
    pattern: /(phpinfo|server.*status|health.*check.*detailed)/i,
    confidence_base: 70,
    recommendation: "Restrict access to diagnostic endpoints",
    references: ["https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/"]
  },

  // ═══════════════════════════════════════════════════════════════
  // A10:2021 - Server-Side Request Forgery (8 signatures)
  // ═══════════════════════════════════════════════════════════════
  {
    id: "SIG-A10-001",
    title: "SSRF Vulnerability Indicators",
    owasp_category: "A10:2021 - Server-Side Request Forgery",
    severity: "high",
    detection_type: "behavior",
    pattern: /[?&](url|uri|callback|proxy|fetch|redirect)=/i,
    confidence_base: 40,
    recommendation: "Validate and whitelist URLs",
    references: ["https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/"]
  },
  {
    id: "SIG-A10-002",
    title: "URL Fetch Without Validation",
    owasp_category: "A10:2021 - Server-Side Request Forgery",
    severity: "critical",
    detection_type: "content_match",
    pattern: /(fetch|curl|wget|request)\s*\(/i,
    confidence_base: 35,
    recommendation: "Whitelist allowed domains and IPs",
    references: ["https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/"]
  },
  {
    id: "SIG-A10-003",
    title: "Internal Network Access Risk",
    owasp_category: "A10:2021 - Server-Side Request Forgery",
    severity: "high",
    detection_type: "behavior",
    pattern: /(localhost|127\.0\.0\.1|192\.168\.|10\.|172\.)/i,
    confidence_base: 50,
    recommendation: "Block requests to internal networks",
    references: ["https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/"]
  },
  {
    id: "SIG-A10-004",
    title: "Cloud Metadata Access Risk",
    owasp_category: "A10:2021 - Server-Side Request Forgery",
    severity: "critical",
    detection_type: "behavior",
    pattern: /169\.254\.169\.254|metadata\.google|instance-data/i,
    confidence_base: 90,
    recommendation: "Block access to cloud metadata endpoints",
    references: ["https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/"]
  },
  {
    id: "SIG-A10-005",
    title: "File Protocol SSRF",
    owasp_category: "A10:2021 - Server-Side Request Forgery",
    severity: "high",
    detection_type: "behavior",
    pattern: /file:\/\/|gopher:\/\/|dict:\/\//i,
    confidence_base: 85,
    recommendation: "Restrict protocol handlers to HTTP/HTTPS",
    references: ["https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/"]
  },
  {
    id: "SIG-A10-006",
    title: "DNS Rebinding Risk",
    owasp_category: "A10:2021 - Server-Side Request Forgery",
    severity: "medium",
    detection_type: "misconfiguration",
    confidence_base: 30,
    recommendation: "Implement DNS pinning and validation",
    references: ["https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/"]
  },
  {
    id: "SIG-A10-007",
    title: "Webhook SSRF Vulnerability",
    owasp_category: "A10:2021 - Server-Side Request Forgery",
    severity: "high",
    detection_type: "content_match",
    pattern: /webhook|callback.*url|notify.*url/i,
    confidence_base: 45,
    recommendation: "Validate webhook URLs against whitelist",
    references: ["https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/"]
  },
  {
    id: "SIG-A10-008",
    title: "PDF Generator SSRF",
    owasp_category: "A10:2021 - Server-Side Request Forgery",
    severity: "high",
    detection_type: "content_match",
    pattern: /(pdf|html2pdf|wkhtmltopdf|puppeteer)/i,
    confidence_base: 40,
    recommendation: "Sanitize HTML/URLs before PDF generation",
    references: ["https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/"]
  },

  // ═══════════════════════════════════════════════════════════════
  // Extended Security Headers (10 signatures)
  // ═══════════════════════════════════════════════════════════════
  {
    id: "SIG-EXT-001",
    title: "Missing Permissions-Policy",
    owasp_category: "Extended Security Headers",
    severity: "low",
    detection_type: "header_missing",
    header_name: "permissions-policy",
    confidence_base: 50,
    recommendation: "Implement Permissions-Policy to control browser features",
    references: ["https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Permissions-Policy"]
  },
  {
    id: "SIG-EXT-002",
    title: "Clickjacking Protection Missing",
    owasp_category: "Extended Security Headers",
    severity: "medium",
    detection_type: "header_missing",
    header_name: "x-frame-options",
    confidence_base: 75,
    recommendation: "Add X-Frame-Options: DENY or implement frame-ancestors in CSP",
    references: ["https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options"]
  },
  {
    id: "SIG-EXT-003",
    title: "Cross-Origin-Opener-Policy Missing",
    owasp_category: "Extended Security Headers",
    severity: "low",
    detection_type: "header_missing",
    header_name: "cross-origin-opener-policy",
    confidence_base: 45,
    recommendation: "Add COOP header for cross-origin isolation",
    references: ["https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cross-Origin-Opener-Policy"]
  },
  {
    id: "SIG-EXT-004",
    title: "Cross-Origin-Embedder-Policy Missing",
    owasp_category: "Extended Security Headers",
    severity: "low",
    detection_type: "header_missing",
    header_name: "cross-origin-embedder-policy",
    confidence_base: 40,
    recommendation: "Add COEP header for embedding control",
    references: ["https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cross-Origin-Embedder-Policy"]
  },
  {
    id: "SIG-EXT-005",
    title: "Cross-Origin-Resource-Policy Missing",
    owasp_category: "Extended Security Headers",
    severity: "medium",
    detection_type: "header_missing",
    header_name: "cross-origin-resource-policy",
    confidence_base: 50,
    recommendation: "Add CORP header to prevent resource leaks",
    references: ["https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cross-Origin-Resource-Policy"]
  },
  {
    id: "SIG-EXT-006",
    title: "Timing-Allow-Origin Not Set",
    owasp_category: "Extended Security Headers",
    severity: "low",
    detection_type: "header_missing",
    header_name: "timing-allow-origin",
    confidence_base: 30,
    recommendation: "Configure Timing-Allow-Origin for performance APIs",
    references: ["https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Timing-Allow-Origin"]
  },
  {
    id: "SIG-EXT-007",
    title: "Feature-Policy Deprecated",
    owasp_category: "Extended Security Headers",
    severity: "info",
    detection_type: "header_value",
    header_name: "feature-policy",
    expected_value: /.+/,
    confidence_base: 80,
    recommendation: "Migrate from Feature-Policy to Permissions-Policy",
    references: ["https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Permissions-Policy"]
  },
  {
    id: "SIG-EXT-008",
    title: "Expect-CT Header Present",
    owasp_category: "Extended Security Headers",
    severity: "info",
    detection_type: "header_value",
    header_name: "expect-ct",
    expected_value: /.+/,
    confidence_base: 60,
    recommendation: "Expect-CT is deprecated; focus on CAA records instead",
    references: ["https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Expect-CT"]
  },
  {
    id: "SIG-EXT-009",
    title: "Public-Key-Pins Detected",
    owasp_category: "Extended Security Headers",
    severity: "info",
    detection_type: "header_value",
    header_name: "public-key-pins",
    expected_value: /.+/,
    confidence_base: 90,
    recommendation: "HPKP is deprecated and dangerous; remove this header",
    references: ["https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Public-Key-Pins"]
  },
  {
    id: "SIG-EXT-010",
    title: "Clear-Site-Data Not Implemented",
    owasp_category: "Extended Security Headers",
    severity: "low",
    detection_type: "header_missing",
    header_name: "clear-site-data",
    confidence_base: 20,
    recommendation: "Use Clear-Site-Data for logout endpoints",
    references: ["https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Clear-Site-Data"]
  },

  // ═══════════════════════════════════════════════════════════════
  // Cloud & API Security (10 signatures)
  // ═══════════════════════════════════════════════════════════════
  {
    id: "SIG-CLOUD-001",
    title: "AWS S3 Bucket Exposed",
    owasp_category: "Cloud Misconfiguration",
    severity: "critical",
    detection_type: "content_match",
    pattern: /\.s3\.amazonaws\.com|s3\..*\.amazonaws\.com/i,
    confidence_base: 70,
    recommendation: "Review S3 bucket policies and enable encryption",
    references: ["https://docs.aws.amazon.com/AmazonS3/latest/userguide/security-best-practices.html"]
  },
  {
    id: "SIG-CLOUD-002",
    title: "Azure Storage Account Exposure",
    owasp_category: "Cloud Misconfiguration",
    severity: "high",
    detection_type: "content_match",
    pattern: /\.blob\.core\.windows\.net|\.file\.core\.windows\.net/i,
    confidence_base: 65,
    recommendation: "Implement Azure Storage firewall rules",
    references: ["https://docs.microsoft.com/azure/storage/common/storage-security-guide"]
  },
  {
    id: "SIG-CLOUD-003",
    title: "Google Cloud Storage Bucket",
    owasp_category: "Cloud Misconfiguration",
    severity: "high",
    detection_type: "content_match",
    pattern: /storage\.googleapis\.com|storage\.cloud\.google\.com/i,
    confidence_base: 70,
    recommendation: "Review GCS bucket IAM permissions",
    references: ["https://cloud.google.com/storage/docs/best-practices"]
  },
  {
    id: "SIG-CLOUD-004",
    title: "API Key in Client-Side Code",
    owasp_category: "Cloud Misconfiguration",
    severity: "critical",
    detection_type: "content_match",
    pattern: /(api[_-]?key|apikey|api[_-]?secret).*[:=]\s*["'][A-Za-z0-9_-]{20,}["']/i,
    confidence_base: 85,
    recommendation: "Move API keys to backend; use environment variables",
    references: ["https://owasp.org/www-project-api-security/"]
  },
  {
    id: "SIG-CLOUD-005",
    title: "GraphQL Introspection Enabled",
    owasp_category: "Cloud Misconfiguration",
    severity: "medium",
    detection_type: "content_match",
    pattern: /__schema|__type.*fields/i,
    confidence_base: 75,
    recommendation: "Disable GraphQL introspection in production",
    references: ["https://owasp.org/www-project-api-security/"]
  },
  {
    id: "SIG-CLOUD-006",
    title: "Unrestricted CORS for API",
    owasp_category: "Cloud Misconfiguration",
    severity: "high",
    detection_type: "header_value",
    header_name: "access-control-allow-origin",
    expected_value: "*",
    confidence_base: 90,
    recommendation: "Restrict CORS to specific origins for APIs",
    references: ["https://owasp.org/www-project-api-security/"]
  },
  {
    id: "SIG-CLOUD-007",
    title: "Missing API Rate Limiting",
    owasp_category: "Cloud Misconfiguration",
    severity: "high",
    detection_type: "header_missing",
    header_name: "x-ratelimit-limit",
    confidence_base: 40,
    recommendation: "Implement rate limiting on API endpoints",
    references: ["https://owasp.org/www-project-api-security/"]
  },
  {
    id: "SIG-CLOUD-008",
    title: "API Versioning Issues",
    owasp_category: "Cloud Misconfiguration",
    severity: "low",
    detection_type: "behavior",
    pattern: /\/api\/(?!v[0-9])/i,
    confidence_base: 30,
    recommendation: "Implement API versioning strategy",
    references: ["https://owasp.org/www-project-api-security/"]
  },
  {
    id: "SIG-CLOUD-009",
    title: "Excessive Data Exposure in API",
    owasp_category: "Cloud Misconfiguration",
    severity: "medium",
    detection_type: "content_match",
    pattern: /(password|ssn|credit.*card|secret).*:/i,
    confidence_base: 40,
    recommendation: "Filter sensitive data from API responses",
    references: ["https://owasp.org/www-project-api-security/"]
  },
  {
    id: "SIG-CLOUD-010",
    title: "Missing API Authentication",
    owasp_category: "Cloud Misconfiguration",
    severity: "critical",
    detection_type: "header_missing",
    header_name: "authorization",
    confidence_base: 35,
    recommendation: "Implement OAuth 2.0 or JWT authentication",
    references: ["https://owasp.org/www-project-api-security/"]
  },

  // ═══════════════════════════════════════════════════════════════
  // DNS & Network Security (8 signatures)
  // ═══════════════════════════════════════════════════════════════
  {
    id: "SIG-DNS-001",
    title: "Missing SPF Record",
    owasp_category: "DNS Security",
    severity: "medium",
    detection_type: "misconfiguration",
    confidence_base: 30,
    recommendation: "Configure SPF record to prevent email spoofing",
    references: ["https://www.cloudflare.com/learning/dns/dns-records/dns-spf-record/"]
  },
  {
    id: "SIG-DNS-002",
    title: "Missing DMARC Record",
    owasp_category: "DNS Security",
    severity: "medium",
    detection_type: "misconfiguration",
    confidence_base: 30,
    recommendation: "Implement DMARC for email authentication",
    references: ["https://www.cloudflare.com/learning/dns/dns-records/dns-dmarc-record/"]
  },
  {
    id: "SIG-DNS-003",
    title: "Missing DKIM Signature",
    owasp_category: "DNS Security",
    severity: "low",
    detection_type: "misconfiguration",
    confidence_base: 25,
    recommendation: "Configure DKIM for email integrity",
    references: ["https://www.cloudflare.com/learning/dns/dns-records/dns-dkim-record/"]
  },
  {
    id: "SIG-DNS-004",
    title: "Missing CAA Record",
    owasp_category: "DNS Security",
    severity: "medium",
    detection_type: "misconfiguration",
    confidence_base: 35,
    recommendation: "Add CAA record to control certificate issuance",
    references: ["https://www.cloudflare.com/learning/dns/dns-records/dns-caa-record/"]
  },
  {
    id: "SIG-DNS-005",
    title: "Zone Transfer Enabled",
    owasp_category: "DNS Security",
    severity: "high",
    detection_type: "misconfiguration",
    confidence_base: 60,
    recommendation: "Disable DNS zone transfers to unauthorized servers",
    references: ["https://www.cloudflare.com/learning/dns/dns-security/"]
  },
  {
    id: "SIG-DNS-006",
    title: "DNSSEC Not Enabled",
    owasp_category: "DNS Security",
    severity: "medium",
    detection_type: "misconfiguration",
    confidence_base: 40,
    recommendation: "Enable DNSSEC to prevent DNS spoofing",
    references: ["https://www.cloudflare.com/dns/dnssec/how-dnssec-works/"]
  },
  {
    id: "SIG-DNS-007",
    title: "IPv6 Not Configured",
    owasp_category: "DNS Security",
    severity: "info",
    detection_type: "misconfiguration",
    confidence_base: 30,
    recommendation: "Consider implementing IPv6 (AAAA records)",
    references: ["https://www.cloudflare.com/learning/dns/dns-records/dns-aaaa-record/"]
  },
  {
    id: "SIG-DNS-008",
    title: "Wildcard DNS Record Risk",
    owasp_category: "DNS Security",
    severity: "low",
    detection_type: "misconfiguration",
    confidence_base: 25,
    recommendation: "Review wildcard DNS records for security implications",
    references: ["https://www.cloudflare.com/learning/dns/dns-records/"]
  }
];

// Export total count
export const SIGNATURE_COUNT = SIGNATURE_DATABASE.length;
