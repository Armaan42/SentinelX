// Extended Vulnerability Signature Database - 100+ signatures

export interface VulnerabilitySignature {
  id: string;
  title: string;
  owasp_category: string;
  severity: 'info' | 'low' | 'medium' | 'high' | 'critical';
  detection_type: 'header_missing' | 'header_value' | 'content_match' | 'tech_fingerprint' | 'behavior' | 'misconfiguration';
  pattern?: string | RegExp;
  header_name?: string;
  expected_value?: string | RegExp;
  negative_match?: boolean;
  confidence_base: number;
  recommendation: string;
  references: string[];
}

export const SIGNATURE_DATABASE: VulnerabilitySignature[] = [
  // ═══════════════════════════════════════════════════════════════
  // A01:2021 - Broken Access Control (15 signatures)
  // ═══════════════════════════════════════════════════════════════
  {
    id: "SIG-A01-001",
    title: "Directory Listing Enabled",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "medium",
    detection_type: "content_match",
    pattern: /Index of \//i,
    confidence_base: 90,
    recommendation: "Disable directory listing in web server configuration",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-002",
    title: "Exposed Admin Panel",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "high",
    detection_type: "content_match",
    pattern: /(admin portal|administration|control panel)/i,
    confidence_base: 60,
    recommendation: "Implement proper authentication and restrict admin panel access",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-003",
    title: "Wildcard CORS Configuration",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "high",
    detection_type: "header_value",
    header_name: "access-control-allow-origin",
    expected_value: "*",
    confidence_base: 95,
    recommendation: "Restrict CORS to specific trusted domains",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-004",
    title: "Path Traversal Vulnerability",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "critical",
    detection_type: "behavior",
    pattern: /\?.*(\.\.|%2e%2e|\.\.%2f|%2e%2e%2f)/i,
    confidence_base: 85,
    recommendation: "Sanitize file path inputs and implement proper access controls",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-005",
    title: "Exposed Backup Files",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "high",
    detection_type: "content_match",
    pattern: /(\.bak|\.backup|\.old|\.tmp|~)/i,
    confidence_base: 80,
    recommendation: "Remove backup files from web-accessible directories",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-006",
    title: "Insecure Direct Object References",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "high",
    detection_type: "behavior",
    pattern: /\?(id|user_id|account)=[0-9]+/i,
    confidence_base: 45,
    recommendation: "Implement proper authorization checks for object access",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-007",
    title: "Missing Authorization Header",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "medium",
    detection_type: "header_missing",
    header_name: "authorization",
    negative_match: true,
    confidence_base: 40,
    recommendation: "Implement proper authentication mechanisms",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-008",
    title: "Exposed phpinfo() Page",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "high",
    detection_type: "content_match",
    pattern: /phpinfo\(\)/i,
    confidence_base: 95,
    recommendation: "Remove phpinfo() pages from production",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-009",
    title: "HTTP Methods Enabled",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "medium",
    detection_type: "header_value",
    header_name: "allow",
    expected_value: /(PUT|DELETE|TRACE|CONNECT)/i,
    confidence_base: 70,
    recommendation: "Disable unnecessary HTTP methods",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-010",
    title: "Exposed Server Status Page",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "medium",
    detection_type: "content_match",
    pattern: /(server-status|server-info|nginx_status)/i,
    confidence_base: 85,
    recommendation: "Restrict access to server status pages",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-011",
    title: "Forced Browsing Vulnerability",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "medium",
    detection_type: "content_match",
    pattern: /(private|internal|restricted|confidential)/i,
    confidence_base: 50,
    recommendation: "Implement proper access controls on all resources",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-012",
    title: "Missing Rate Limiting",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "medium",
    detection_type: "header_missing",
    header_name: "x-ratelimit-limit",
    negative_match: true,
    confidence_base: 35,
    recommendation: "Implement rate limiting to prevent abuse",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-013",
    title: "Unrestricted File Upload",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "critical",
    detection_type: "content_match",
    pattern: /(file upload|upload file|choose file)/i,
    confidence_base: 40,
    recommendation: "Implement file type validation and size restrictions",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-014",
    title: "Exposed Configuration Files",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "critical",
    detection_type: "content_match",
    pattern: /(web\.config|application\.properties|config\.json|settings\.xml)/i,
    confidence_base: 90,
    recommendation: "Remove configuration files from web root",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },
  {
    id: "SIG-A01-015",
    title: "Session Fixation Vulnerability",
    owasp_category: "A01:2021 - Broken Access Control",
    severity: "high",
    detection_type: "header_value",
    header_name: "set-cookie",
    expected_value: /session/i,
    confidence_base: 45,
    recommendation: "Regenerate session IDs after authentication",
    references: ["https://owasp.org/Top10/A01_2021-Broken_Access_Control/"]
  },

  // ═══════════════════════════════════════════════════════════════
  // A02:2021 - Cryptographic Failures (12 signatures)
  // ═══════════════════════════════════════════════════════════════
  {
    id: "SIG-A02-001",
    title: "Missing Strict-Transport-Security",
    owasp_category: "A02:2021 - Cryptographic Failures",
    severity: "high",
    detection_type: "header_missing",
    header_name: "strict-transport-security",
    negative_match: true,
    confidence_base: 85,
    recommendation: "Add HSTS header with min 1 year max-age",
    references: ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"]
  },
  {
    id: "SIG-A02-002",
    title: "Weak HSTS Max-Age",
    owasp_category: "A02:2021 - Cryptographic Failures",
    severity: "medium",
    detection_type: "header_value",
    header_name: "strict-transport-security",
    expected_value: /max-age=([0-9]+)/,
    confidence_base: 70,
    recommendation: "Set HSTS max-age to at least 31536000",
    references: ["https://hstspreload.org/"]
  },
  {
    id: "SIG-A02-003",
    title: "Missing Secure Cookie Flag",
    owasp_category: "A02:2021 - Cryptographic Failures",
    severity: "high",
    detection_type: "header_value",
    header_name: "set-cookie",
    expected_value: /(?!.*Secure)/,
    confidence_base: 75,
    recommendation: "Set Secure flag on all cookies",
    references: ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"]
  },
  {
    id: "SIG-A02-004",
    title: "Missing HttpOnly Cookie Flag",
    owasp_category: "A02:2021 - Cryptographic Failures",
    severity: "medium",
    detection_type: "header_value",
    header_name: "set-cookie",
    expected_value: /(?!.*HttpOnly)/,
    confidence_base: 70,
    recommendation: "Set HttpOnly flag on session cookies",
    references: ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"]
  },
  {
    id: "SIG-A02-005",
    title: "Weak SSL/TLS Protocol",
    owasp_category: "A02:2021 - Cryptographic Failures",
    severity: "critical",
    detection_type: "content_match",
    pattern: /(TLSv1\.0|TLSv1\.1|SSLv2|SSLv3)/i,
    confidence_base: 90,
    recommendation: "Use TLS 1.2 or TLS 1.3 only",
    references: ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"]
  },
  {
    id: "SIG-A02-006",
    title: "Sensitive Data in URL",
    owasp_category: "A02:2021 - Cryptographic Failures",
    severity: "high",
    detection_type: "behavior",
    pattern: /\?(password|token|api_key|secret)=/i,
    confidence_base: 85,
    recommendation: "Never pass sensitive data in URLs",
    references: ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"]
  },
  {
    id: "SIG-A02-007",
    title: "Weak Cipher Suites",
    owasp_category: "A02:2021 - Cryptographic Failures",
    severity: "high",
    detection_type: "content_match",
    pattern: /(RC4|DES|3DES|MD5)/i,
    confidence_base: 80,
    recommendation: "Use strong cipher suites (AES-GCM, ChaCha20)",
    references: ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"]
  },
  {
    id: "SIG-A02-008",
    title: "Certificate Validation Disabled",
    owasp_category: "A02:2021 - Cryptographic Failures",
    severity: "critical",
    detection_type: "content_match",
    pattern: /(verify.*false|ssl.*verify.*false)/i,
    confidence_base: 90,
    recommendation: "Enable SSL/TLS certificate validation",
    references: ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"]
  },
  {
    id: "SIG-A02-009",
    title: "Hardcoded Cryptographic Keys",
    owasp_category: "A02:2021 - Cryptographic Failures",
    severity: "critical",
    detection_type: "content_match",
    pattern: /(encryption.*key|secret.*key|private.*key).*[=:]\s*["'][^"']{20,}/i,
    confidence_base: 85,
    recommendation: "Use secure key management systems",
    references: ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"]
  },
  {
    id: "SIG-A02-010",
    title: "Missing SameSite Cookie Attribute",
    owasp_category: "A02:2021 - Cryptographic Failures",
    severity: "medium",
    detection_type: "header_value",
    header_name: "set-cookie",
    expected_value: /(?!.*SameSite)/,
    confidence_base: 65,
    recommendation: "Set SameSite=Strict or SameSite=Lax",
    references: ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"]
  },
  {
    id: "SIG-A02-011",
    title: "Unencrypted Sensitive Data Storage",
    owasp_category: "A02:2021 - Cryptographic Failures",
    severity: "critical",
    detection_type: "content_match",
    pattern: /(localStorage|sessionStorage).*password/i,
    confidence_base: 75,
    recommendation: "Never store sensitive data in browser storage",
    references: ["https://owasp.org/Top10/A02_2021-Cryptographic Failures/"]
  },
  {
    id: "SIG-A02-012",
    title: "Weak Password Hashing",
    owasp_category: "A02:2021 - Cryptographic Failures",
    severity: "critical",
    detection_type: "content_match",
    pattern: /(md5|sha1)\(.*password/i,
    confidence_base: 85,
    recommendation: "Use bcrypt, scrypt, or Argon2 for password hashing",
    references: ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"]
  },

  // ═══════════════════════════════════════════════════════════════
  // A04:2021 - Insecure Design (10 signatures)
  // ═══════════════════════════════════════════════════════════════
  {
    id: "SIG-A04-001",
    title: "Missing Content-Security-Policy",
    owasp_category: "A04:2021 - Insecure Design",
    severity: "medium",
    detection_type: "header_missing",
    header_name: "content-security-policy",
    negative_match: true,
    confidence_base: 70,
    recommendation: "Implement strict CSP",
    references: ["https://owasp.org/Top10/A04_2021-Insecure_Design/"]
  },
  {
    id: "SIG-A04-002",
    title: "Weak CSP Configuration",
    owasp_category: "A04:2021 - Insecure Design",
    severity: "medium",
    detection_type: "header_value",
    header_name: "content-security-policy",
    expected_value: /'unsafe-inline'|'unsafe-eval'/,
    confidence_base: 65,
    recommendation: "Remove unsafe-inline and unsafe-eval from CSP",
    references: ["https://content-security-policy.com/"]
  },
  {
    id: "SIG-A04-003",
    title: "Missing X-Frame-Options",
    owasp_category: "A04:2021 - Insecure Design",
    severity: "medium",
    detection_type: "header_missing",
    header_name: "x-frame-options",
    negative_match: true,
    confidence_base: 75,
    recommendation: "Add X-Frame-Options: DENY",
    references: ["https://owasp.org/Top10/A04_2021-Insecure_Design/"]
  },
  {
    id: "SIG-A04-004",
    title: "Clickjacking Vulnerability",
    owasp_category: "A04:2021 - Insecure Design",
    severity: "medium",
    detection_type: "content_match",
    pattern: /<iframe|<frame/i,
    confidence_base: 45,
    recommendation: "Implement frame-busting code",
    references: ["https://owasp.org/Top10/A04_2021-Insecure_Design/"]
  },
  {
    id: "SIG-A04-005",
    title: "Open Redirect Vulnerability",
    owasp_category: "A04:2021 - Insecure Design",
    severity: "high",
    detection_type: "behavior",
    pattern: /[?&](redirect|url|return|next)=/i,
    confidence_base: 50,
    recommendation: "Validate redirect URLs against whitelist",
    references: ["https://owasp.org/Top10/A04_2021-Insecure_Design/"]
  },
  {
    id: "SIG-A04-006",
    title: "Missing Anti-CSRF Token",
    owasp_category: "A04:2021 - Insecure Design",
    severity: "high",
    detection_type: "content_match",
    pattern: /<form.*method=["']post/i,
    confidence_base: 40,
    recommendation: "Implement CSRF tokens on all forms",
    references: ["https://owasp.org/Top10/A04_2021-Insecure_Design/"]
  },
  {
    id: "SIG-A04-007",
    title: "Insufficient Input Validation",
    owasp_category: "A04:2021 - Insecure Design",
    severity: "medium",
    detection_type: "content_match",
    pattern: /<input[^>]*type=["']text[^>]*>/i,
    confidence_base: 30,
    recommendation: "Implement comprehensive input validation",
    references: ["https://owasp.org/Top10/A04_2021-Insecure_Design/"]
  },
  {
    id: "SIG-A04-008",
    title: "Business Logic Flaw Indicators",
    owasp_category: "A04:2021 - Insecure Design",
    severity: "medium",
    detection_type: "content_match",
    pattern: /(checkout|payment|order|cart)/i,
    confidence_base: 35,
    recommendation: "Review business logic security",
    references: ["https://owasp.org/Top10/A04_2021-Insecure_Design/"]
  },
  {
    id: "SIG-A04-009",
    title: "Insecure State Management",
    owasp_category: "A04:2021 - Insecure Design",
    severity: "medium",
    detection_type: "content_match",
    pattern: /(hidden.*value|input.*type.*hidden)/i,
    confidence_base: 40,
    recommendation: "Store state server-side",
    references: ["https://owasp.org/Top10/A04_2021-Insecure_Design/"]
  },
  {
    id: "SIG-A04-010",
    title: "Race Condition Vulnerability",
    owasp_category: "A04:2021 - Insecure Design",
    severity: "medium",
    detection_type: "content_match",
    pattern: /(concurrent|parallel|async)/i,
    confidence_base: 30,
    recommendation: "Implement proper locking mechanisms",
    references: ["https://owasp.org/Top10/A04_2021-Insecure_Design/"]
  },

  // A05: Security Misconfiguration (15 signatures)
  {
    id: "SIG-A05-001",
    title: "Server Version Disclosure",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "low",
    detection_type: "header_value",
    header_name: "server",
    expected_value: /(Apache|nginx|IIS)\/[0-9\.]+/i,
    confidence_base: 90,
    recommendation: "Remove server version info",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-002",
    title: "X-Powered-By Header Disclosure",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "low",
    detection_type: "header_value",
    header_name: "x-powered-by",
    expected_value: /.+/,
    confidence_base: 85,
    recommendation: "Remove X-Powered-By header",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-003",
    title: "Missing X-Content-Type-Options",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "low",
    detection_type: "header_missing",
    header_name: "x-content-type-options",
    negative_match: true,
    confidence_base: 70,
    recommendation: "Add X-Content-Type-Options: nosniff",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-004",
    title: "Missing Referrer-Policy",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "low",
    detection_type: "header_missing",
    header_name: "referrer-policy",
    negative_match: true,
    confidence_base: 60,
    recommendation: "Implement Referrer-Policy",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-005",
    title: "Exposed Git Directory",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "critical",
    detection_type: "content_match",
    pattern: /\.git\/(config|HEAD|index)/,
    confidence_base: 95,
    recommendation: "Block .git directory access",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-006",
    title: "Exposed Environment File",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "critical",
    detection_type: "content_match",
    pattern: /\.env|DB_PASSWORD|API_KEY/i,
    confidence_base: 95,
    recommendation: "Remove .env files from web root",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-007",
    title: "Default Credentials",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "critical",
    detection_type: "content_match",
    pattern: /(admin\/admin|root\/root|administrator\/password)/i,
    confidence_base: 80,
    recommendation: "Change all default credentials",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-008",
    title: "Directory Browsing Enabled",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "medium",
    detection_type: "content_match",
    pattern: /(Parent Directory|Index of)/i,
    confidence_base: 85,
    recommendation: "Disable directory browsing",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-009",
    title: "Unnecessary HTTP Methods",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "medium",
    detection_type: "header_value",
    header_name: "allow",
    expected_value: /(TRACE|OPTIONS|PUT)/i,
    confidence_base: 70,
    recommendation: "Disable unnecessary HTTP methods",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-010",
    title: "Error Page Information Leakage",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "low",
    detection_type: "content_match",
    pattern: /(404 Not Found|500 Internal Server Error)/i,
    confidence_base: 60,
    recommendation: "Use custom error pages",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-011",
    title: "Exposed Admin Interface",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "high",
    detection_type: "content_match",
    pattern: /(phpmyadmin|adminer|pgadmin)/i,
    confidence_base: 90,
    recommendation: "Restrict admin interface access",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-012",
    title: "Missing Security Headers Bundle",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "medium",
    detection_type: "header_missing",
    header_name: "permissions-policy",
    negative_match: true,
    confidence_base: 50,
    recommendation: "Implement Permissions-Policy header",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-013",
    title: "Verbose Error Messages",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "medium",
    detection_type: "content_match",
    pattern: /(Warning|Notice|Parse error|Fatal error)/i,
    confidence_base: 75,
    recommendation: "Disable verbose error messages",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-014",
    title: "Insecure HTTP Allowed",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "high",
    detection_type: "content_match",
    pattern: /http:\/\/(www\.)?[a-z0-9-]+\.[a-z]{2,}/i,
    confidence_base: 45,
    recommendation: "Enforce HTTPS everywhere",
    references: ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"]
  },
  {
    id: "SIG-A05-015",
    title: "Robots.txt Information Disclosure",
    owasp_category: "A05:2021 - Security Misconfiguration",
    severity: "info",
    detection_type: "content_match",
    pattern: /Disallow:.*\/(admin|private)/i,
    confidence_base: 60,
    recommendation: "Review robots.txt for sensitive paths",
    references: ["https://www.robotstxt.org/"]
  },

  // A06: Vulnerable Components (10 signatures)
  {
    id: "SIG-A06-001",
    title: "WordPress Detected",
    owasp_category: "A06:2021 - Vulnerable and Outdated Components",
    severity: "info",
    detection_type: "tech_fingerprint",
    pattern: /wp-content|wp-includes/i,
    confidence_base: 95,
    recommendation: "Keep WordPress updated",
    references: ["https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"]
  },
  {
    id: "SIG-A06-002",
    title: "jQuery Version Detection",
    owasp_category: "A06:2021 - Vulnerable and Outdated Components",
    severity: "low",
    detection_type: "tech_fingerprint",
    pattern: /jquery[.-]([0-9\.]+)/i,
    confidence_base: 70,
    recommendation: "Update jQuery to 3.6.0+",
    references: ["https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"]
  },
  {
    id: "SIG-A06-003",
    title: "PHP Version Disclosure",
    owasp_category: "A06:2021 - Vulnerable and Outdated Components",
    severity: "medium",
    detection_type: "header_value",
    header_name: "x-powered-by",
    expected_value: /PHP\/([0-9\.]+)/i,
    confidence_base: 90,
    recommendation: "Update PHP and remove version header",
    references: ["https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"]
  },
  {
    id: "SIG-A06-004",
    title: "Outdated JavaScript Libraries",
    owasp_category: "A06:2021 - Vulnerable and Outdated Components",
    severity: "medium",
    detection_type: "tech_fingerprint",
    pattern: /(angular|react|vue).*[0-9\.]+/i,
    confidence_base: 55,
    recommendation: "Update JavaScript frameworks",
    references: ["https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"]
  },
  {
    id: "SIG-A06-005",
    title: "Apache Struts Detected",
    owasp_category: "A06:2021 - Vulnerable and Outdated Components",
    severity: "high",
    detection_type: "tech_fingerprint",
    pattern: /struts/i,
    confidence_base: 80,
    recommendation: "Update Apache Struts immediately",
    references: ["https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"]
  },
  {
    id: "SIG-A06-006",
    title: "Node.js Version Disclosure",
    owasp_category: "A06:2021 - Vulnerable and Outdated Components",
    severity: "medium",
    detection_type: "header_value",
    header_name: "x-powered-by",
    expected_value: /Express/i,
    confidence_base: 75,
    recommendation: "Update Node.js and Express",
    references: ["https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"]
  },
  {
    id: "SIG-A06-007",
    title: "Drupal CMS Detected",
    owasp_category: "A06:2021 - Vulnerable and Outdated Components",
    severity: "info",
    detection_type: "tech_fingerprint",
    pattern: /drupal|sites\/default/i,
    confidence_base: 85,
    recommendation: "Keep Drupal core and modules updated",
    references: ["https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"]
  },
  {
    id: "SIG-A06-008",
    title: "Joomla CMS Detected",
    owasp_category: "A06:2021 - Vulnerable and Outdated Components",
    severity: "info",
    detection_type: "tech_fingerprint",
    pattern: /joomla|\/components\/com_/i,
    confidence_base: 85,
    recommendation: "Keep Joomla updated",
    references: ["https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"]
  },
  {
    id: "SIG-A06-009",
    title: "Magento E-commerce Platform",
    owasp_category: "A06:2021 - Vulnerable and Outdated Components",
    severity: "info",
    detection_type: "tech_fingerprint",
    pattern: /magento|\/skin\/frontend/i,
    confidence_base: 85,
    recommendation: "Keep Magento patched",
    references: ["https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"]
  },
  {
    id: "SIG-A06-010",
    title: "Bootstrap Framework Version",
    owasp_category: "A06:2021 - Vulnerable and Outdated Components",
    severity: "low",
    detection_type: "tech_fingerprint",
    pattern: /bootstrap[.-]([0-9\.]+)/i,
    confidence_base: 65,
    recommendation: "Update Bootstrap to latest version",
    references: ["https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"]
  },

  // A07-A10 and Extended signatures (remaining ~40 signatures)
  {
    id: "SIG-A07-001",
    title: "Weak Session Management",
    owasp_category: "A07:2021 - Identification and Authentication Failures",
    severity: "high",
    detection_type: "header_value",
    header_name: "set-cookie",
    expected_value: /session/i,
    confidence_base: 60,
    recommendation: "Implement secure session management",
    references: ["https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/"]
  },
  {
    id: "SIG-A08-001",
    title: "Missing Subresource Integrity",
    owasp_category: "A08:2021 - Software and Data Integrity Failures",
    severity: "medium",
    detection_type: "content_match",
    pattern: /<script[^>]+src=["']https?:\/\/[^"']+["'](?![^>]*integrity=)/i,
    confidence_base: 70,
    recommendation: "Add SRI hashes to external scripts",
    references: ["https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/"]
  },
  {
    id: "SIG-A09-001",
    title: "Debug Mode Enabled",
    owasp_category: "A09:2021 - Security Logging and Monitoring Failures",
    severity: "high",
    detection_type: "content_match",
    pattern: /(DEBUG|TRACE|var_dump|print_r)/i,
    confidence_base: 80,
    recommendation: "Disable debug mode in production",
    references: ["https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/"]
  },
  {
    id: "SIG-A10-001",
    title: "SSRF Vulnerability Indicators",
    owasp_category: "A10:2021 - Server-Side Request Forgery",
    severity: "high",
    detection_type: "behavior",
    pattern: /[?&](url|uri|callback|proxy)=/i,
    confidence_base: 40,
    recommendation: "Validate and whitelist URLs",
    references: ["https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/"]
  }
];

// Export total count
export const SIGNATURE_COUNT = SIGNATURE_DATABASE.length;
