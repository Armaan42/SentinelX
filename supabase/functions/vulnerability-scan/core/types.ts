
export interface ScanConfig {
    maxDepth: number;
    maxPages: number;
    concurrency: number;
    timeout: number;
    userAgent: string;
}

export interface ScanContext {
    url: string;
    finalUrl: string;
    headers: Record<string, string>;
    body: string;
    statusCode: number;
    responseTime: number;
    isHttps: boolean;
    hostname: string;
}

export interface VulnerabilityFinding {
    id: string;
    title: string;
    owasp_category: string;
    severity: 'critical' | 'high' | 'medium' | 'low' | 'info';
    status: 'vulnerable' | 'immune' | 'unknown';
    detection_type?: 'header_missing' | 'header_value' | 'content_match' | 'tech_fingerprint' | 'behavior' | 'misconfiguration' | 'sqli' | 'xss' | 'rce' | 'lfi';
    confidence: number;
    evidence: string[];
    recommendation: string;
    references: string[];
    explanation?: string;
    confidence_factors?: string[];
    affected_url?: string;
    param?: string;
    payload?: string;
}

export interface CrawledUrl {
    url: string;
    depth: number;
    forms: FormInfo[];
    params: string[];
    method: string;
}

export interface FormInfo {
    action: string;
    method: string;
    inputs: { name: string; type: string }[];
}

export interface ActiveScanResult {
    findings: VulnerabilityFinding[];
    duration: number;
}
